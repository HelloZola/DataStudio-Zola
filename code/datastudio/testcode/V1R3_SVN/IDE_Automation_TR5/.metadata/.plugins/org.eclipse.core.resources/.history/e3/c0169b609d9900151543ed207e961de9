/*************************************************************************
TITLE - IDE LOGIN/LOGOUT
DESCRIPTION - SCRIPT FOR IDE LOGIN AND IDE LOGOUT
AUTHORS - AWX321824
CREATED DATE - 16-NOV-2015
LAST UPDATED DATE - 16-NOV-2015
MODIFICATION HISTORY - 
TEST CASES COVERED - NA
*************************************************************************/
package script_library;


import java.awt.Robot;
import java.awt.event.KeyEvent;
import java.io.File;

import com.jacob.com.LibraryLoader;

import object_repository.LoginElements;
import object_repository.ObjectBrowserElements;
import support_functions.BaseActions;
import autoitx4java.AutoItX;

public class Login {
	
	public static void LaunchIDE(String path) throws Exception {
		File file = new File("lib", "jacob-1.18-x86.dll");
		System.setProperty(LibraryLoader.JACOB_DLL_PATH, file.getAbsolutePath());
		AutoItX x = new AutoItX();
		if(x.winExists("Gauss200 OLAP IDE"))
		{
			x.winClose("Gauss200 OLAP IDE");
		}
		x.run(path);
		Thread.sleep(1000);
		x.winWait("New Database Connection");
		x.winActive("New Database Connection");
	}
	public static void IDELogin(String sConnectionName,String sHost,String sHostPort,String sDBName,String sUsername,String sPassword) throws Exception
	{
		
		BaseActions.SetText(LoginElements.wDBConnection, "", LoginElements.sConnectionName,sConnectionName);
		BaseActions.SetText(LoginElements.wDBConnection, "", LoginElements.sHost, sHost);
		BaseActions.SetText(LoginElements.wDBConnection, "", LoginElements.sHostPort, sHostPort);
		BaseActions.SetText(LoginElements.wDBConnection, "", LoginElements.sDBName, sDBName);
		BaseActions.SetText(LoginElements.wDBConnection, "", LoginElements.sUsername, sUsername);
		BaseActions.SetText(LoginElements.wDBConnection, "", LoginElements.sPassword, sPassword);
		Thread.sleep(100);
		BaseActions.Click(LoginElements.wDBConnection, "", LoginElements.bOK);
		Thread.sleep(1000);
	}
	public static void IDELogout() throws Exception
	 {
	    AutoItX x = new AutoItX();
	    x.winActivate("Gauss200 OLAP IDE");
	    Robot r = new Robot();
		BaseActions.MouseClick(ObjectBrowserElements.wTitle, "", ObjectBrowserElements.sControlID, ObjectBrowserElements.sButton, ObjectBrowserElements.nclicks,
								ObjectBrowserElements.xcord, ObjectBrowserElements.ycord);
		r.keyPress(KeyEvent.VK_ALT);
		r.keyRelease(KeyEvent.VK_ALT);
		r.keyPress(KeyEvent.VK_F);
		r.keyRelease(KeyEvent.VK_F);
		r.keyPress(KeyEvent.VK_R);
		r.keyRelease(KeyEvent.VK_R);
		Thread.sleep(100);
		r.keyPress(KeyEvent.VK_ENTER);
		r.keyRelease(KeyEvent.VK_ENTER);
		Thread.sleep(100);
	 	x.winClose("Gauss200 OLAP IDE");
	 	}
  
}