package ide_driver;

import java.io.File;

import script_library.Login;
import script_library.ObjectBrowserToolBar;
import script_library.QueryEditor;
import support_functions.UtilityFunctions;
import test_scripts.AR_Tools_IDE_020_007_QRY_FMT;

import com.jacob.com.LibraryLoader;

public class IDEAutomationDriverScript {
	
	public static void main(String args[]) throws Exception
	{
		/*//Loading required DLL for AutoIT
		File Jacob = new File("lib", "jacob-1.18-x86.dll");
		System.setProperty(LibraryLoader.JACOB_DLL_PATH,Jacob.getAbsolutePath());
		
		String sData = UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "AR.Tools.IDE.020.007", 8,3 );
		System.out.print(sData);
		
		
		//Creating the Test Result File for Reporting
		String sResultExcel = UtilityFunctions.CreateResultFile("FunctionalTest");
		//Launching the IDE Tool Application
		Login.LaunchIDE("C:/Project_DB_Tool_Automation_Suite/IDE/IDE_Tool/Gauss200 OLAP IDE.exe");
		Thread.sleep(1000);
		//Getting Login Credentials from IDE_Smoke_Test_Data file and user logs into IDE Tool
		String sConnection=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 0);
		String sHost=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 1);
		String sHostPort=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 2);
		String sDBName=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 3);
		String sUserName=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 4);
		String sPassword=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 5);
		Login.IDELogin(sConnection,sHost,sHostPort,sDBName,sUserName,sPassword);
		//Getting Execute Status from Driver Data Table
		int iRowCount = UtilityFunctions.GetRowCount("IDE_Functional_Test_Data.xlsx", "Driver_Data_Table");
		for(int i=1;i<=iRowCount;i++)
		{
			String sARNumber=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "Driver_Data_Table", i+1, 1);
			String sExecute=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "Driver_Data_Table", i+1, 3);
			if (sARNumber.equals("AR.Tools.IDE.020.007") && sExecute.equals("Yes"))
			{
				//AR_Tools_IDE_020_007_QRY_FMT.AR_Tools_IDE_020_007_QRY_FMT_001(sResultExcel);
			}
			if (sARNumber.equals("AR.Tools.IDE.030.004") && sExecute.equals("Yes"))
			{
				
			}
		}*/
		
		File Jacob = new File("lib", "jacob-1.18-x86.dll");
		System.setProperty(LibraryLoader.JACOB_DLL_PATH,Jacob.getAbsolutePath());
		String sFlag, sWindowFlag, sInputQuery,sHelpFlag,sEmptyFlag,sResult,sQueryType;
		
		String ResultExcel = UtilityFunctions.CreateResultFile("FunctionalTest");
		//Launching the IDE Tool Application
		Login.LaunchIDE("C:/Project_DB_Tool_Automation_Suite/IDE/IDE_Tool/Gauss200 OLAP IDE.exe");
		Thread.sleep(1000);
		//Getting Login Credentials from IDE_Functional_Test_Data file and user logs into IDE Tool
		String sConnection=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 0);
		String sHost=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 1);
		String sHostPort=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 2);
		String sDBName=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 3);
		String sUserName=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 4);
		String sPassword=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "IDELogin", 1, 5);
		Login.IDELogin(sConnection,sHost,sHostPort,sDBName,sUserName,sPassword);
	
		sInputQuery=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "AR.Tools.IDE.040.003", 1,2 );
		sQueryType=UtilityFunctions.GetExcelCellValue("IDE_Functional_Test_Data.xlsx", "AR.Tools.IDE.040.003", 1,3 );
		Thread.sleep(1000);
		sFlag = QueryEditor.SingleQueryExe(sInputQuery,sQueryType);
		ObjectBrowserToolBar.ObjectBrowser();

	}

}
